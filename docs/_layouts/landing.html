<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{{ page.title | default: site.title }}</title>
    <meta name="description" content="{{ page.meta.description | default: site.description }}" />
    
    <!-- Canonical URL -->
    <link rel="canonical" href="{{ page.url | absolute_url }}" />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="{{ page.url | absolute_url }}" />
    <meta property="og:title" content="{{ page.title | default: site.title }}" />
    <meta property="og:description" content="{{ page.meta.description | default: site.description }}" />
    <meta property="og:image" content="{{ page.meta.image | default: '/images/davinci-codex-hero.jpg' | relative_url | absolute_url }}" />
    <meta property="og:site_name" content="{{ site.title }}" />
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="{{ page.url | absolute_url }}" />
    <meta name="twitter:title" content="{{ page.title | default: site.title }}" />
    <meta name="twitter:description" content="{{ page.meta.description | default: site.description }}" />
    <meta name="twitter:image" content="{{ page.meta.image | default: '/images/davinci-codex-hero.jpg' | relative_url | absolute_url }}" />
    {% if site.twitter_username %}
    <meta name="twitter:site" content="@{{ site.twitter_username }}" />
    {% endif %}
    
    <!-- Structured Data for SEO -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "{{ site.title }}",
      "url": "{{ site.url }}{{ site.baseurl }}",
      "description": "{{ site.description }}",
      "logo": "{{ '/images/codex_logo.png' | relative_url | absolute_url }}",
      "email": "{{ site.email }}",
      "sameAs": [
        "https://github.com/Shannon-Labs/davinci-codex"{% if site.twitter_username %},
        "https://twitter.com/{{ site.twitter_username }}"{% endif %}
      ],
      "founder": {
        "@type": "Person",
        "name": "Hunter Bown",
        "url": "https://shannonlabs.dev"
      },
      "keywords": "{{ page.meta.keywords | default: 'Leonardo da Vinci, mechanical engineering, Renaissance, computational archaeology, historical simulation' }}"
    }
    </script>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@500;600;700&family=EB+Garamond:ital,wght@0,400;0,500;0,600;1,400;1,500&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="{{ 'assets/css/main.css' | relative_url }}" />
    <link rel="stylesheet" href="{{ 'assets/css/renaissance.css' | relative_url }}" />
    <link rel="stylesheet" href="{{ 'assets/css/landing.css' | relative_url }}" />
    <link rel="stylesheet" href="{{ 'assets/css/codex-anima.css' | relative_url }}" />

    <!-- Favicon -->
    {% include favicon.html %}
    
    <!-- Analytics -->
    {% include analytics.html %}
    
    <!-- Preload critical resources -->
    <link rel="preload" href="{{ 'assets/js/renaissance.js' | relative_url }}" as="script">
  </head>
  <body class="page-landing">
    {% include navbar.html %}
    
    <main class="landing-main">
      <!-- Hero Section -->
      {% include hero.html %}
      
      <!-- Dynamic Sections -->
      {% for section in page.sections %}
        <section id="{{ section.id }}" class="page-section {{ section.layout | default: 'default' }}">
          <div class="container">
            
            {% if section.title %}
            <div class="section-header">
              <h2 class="section-title fade-in">{{ section.title }}</h2>
              {% if section.subtitle %}
              <p class="section-subtitle fade-in">{{ section.subtitle }}</p>
              {% endif %}
              {% if section.intro %}
              <div class="section-intro fade-in">{{ section.intro | markdownify }}</div>
              {% endif %}
            </div>
            {% endif %}

            <!-- Hero Split Layout -->
            {% if section.layout == 'hero-split' %}
              <div class="hero-split">
                {% if section.intro %}
                <div class="intro fade-in">{{ section.intro | markdownify }}</div>
                {% endif %}

                {% if section.primary %}
                <div class="hero-split-primary fade-in">
                  <h3>{{ section.primary.heading }}</h3>
                  <p>{{ section.primary.description }}</p>
                  {% if section.primary.highlights %}
                  <ul class="highlights">
                    {% for highlight in section.primary.highlights %}
                    <li>{{ highlight }}</li>
                    {% endfor %}
                  </ul>
                  {% endif %}
                  {% if section.primary.cta %}
                  <a href="{{ section.primary.cta.href }}" class="button primary">{{ section.primary.cta.label }}</a>
                  {% endif %}
                </div>
                {% endif %}

                {% if section.secondary %}
                <div class="hero-split-secondary fade-in">
                  {% if section.secondary.image %}
                  <img src="{{ section.secondary.image | relative_url }}" alt="{{ section.secondary.caption | default: 'Historical manuscript' }}" loading="lazy">
                  {% endif %}
                  {% if section.secondary.caption %}
                  <p class="caption">{{ section.secondary.caption }}</p>
                  {% endif %}
                </div>
                {% endif %}
              </div>
            {% endif %}

            <!-- Category Showcase Layout -->
            {% if section.layout == 'category-showcase' %}
              <div class="categories-grid">
                {% for category in section.categories %}
                <div class="category-card slide-in-left">
                  <div class="category-header" style="background: {{ category.gradient | default: category.color }};">
                    <h3 class="category-title">{{ category.title }}</h3>
                    <p class="category-subtitle">{{ category.subtitle }}</p>
                    <p class="category-description">{{ category.description }}</p>
                  </div>
                  <div class="inventions-list">
                    {% for invention in category.inventions %}
                    <a href="{{ invention.href }}" class="invention-card">
                      <div class="invention-image" {% if invention.image %}style="background-image: url('{{ invention.image | relative_url }}'); background-size: cover; background-position: center;"{% endif %}>
                        <div class="invention-status-icon">
                          {{ invention.status | replace: '_', ' ' | capitalize }}
                        </div>
                      </div>
                      <div class="invention-content">
                        <h4 class="invention-name">{{ invention.name }}</h4>
                        <span class="invention-status">{{ invention.status | replace: '_', ' ' | capitalize }}</span>
                        <p class="invention-achievement">{{ invention.achievement }}</p>
                        <p class="invention-description">{{ invention.description }}</p>
                        <div class="invention-stats">
                          {% for stat in invention.stats %}
                          <span class="invention-stat">{{ stat }}</span>
                          {% endfor %}
                        </div>
                      </div>
                    </a>
                    {% endfor %}
                  </div>
                </div>
                {% endfor %}
              </div>
            {% endif %}
            
            <!-- Methodology Layout -->
            {% if section.layout == 'methodology' %}
              <div class="methodology-stages">
                {% for stage in section.stages %}
                <div class="stage-card fade-in" style="--delay: {{ forloop.index0 | times: 0.1 }}s;">
                  <div class="stage-icon" style="background: {{ stage.color }};">
                    {{ forloop.index }}
                  </div>
                  <h3 class="stage-title">{{ stage.title }}</h3>
                  <p class="stage-description">{{ stage.description }}</p>
                  <ul class="stage-details">
                    {% for detail in stage.details %}
                    <li>{{ detail }}</li>
                    {% endfor %}
                  </ul>
                  <div class="stage-deliverable">
                    <strong>Deliverable:</strong> {{ stage.deliverable }}
                  </div>
                </div>
                {% endfor %}
              </div>
            {% endif %}
            
            <!-- Get Started Layout -->
            {% if section.layout == 'get-started' %}
              <div class="paths-grid">
                {% for path in section.paths %}
                <div class="path-card slide-in-right" style="--delay: {{ forloop.index0 | times: 0.15 }}s;">
                  <div class="path-icon">{{ path.icon }}</div>
                  <h3 class="path-title">{{ path.title }}</h3>
                  <p class="path-description">{{ path.description }}</p>
                  <ol class="path-steps">
                    {% for step in path.steps %}
                    <li>{{ step }}</li>
                    {% endfor %}
                  </ol>
                  <a href="{{ path.cta.href }}" class="button primary">{{ path.cta.label }}</a>
                </div>
                {% endfor %}
              </div>
            {% endif %}
            
            <!-- Contact Layout -->
            {% if section.layout == 'contact' %}
              <div class="contact-grid">
                {% for contact in section.contact_info %}
                <div class="contact-card fade-in">
                  <div class="contact-type">{{ contact.type | capitalize }}</div>
                  <div class="contact-label">{{ contact.label }}</div>
                  <div class="contact-value">
                    {% if contact.type == 'email' %}
                      <a href="mailto:{{ contact.contact }}">{{ contact.value }}</a>
                    {% else %}
                      <a href="{{ contact.contact }}" target="_blank">{{ contact.value }}</a>
                    {% endif %}
                  </div>
                  <p class="contact-description">{{ contact.description }}</p>
                </div>
                {% endfor %}
              </div>
            {% endif %}
            
            <!-- Default Layout -->
            {% if section.layout == 'default' or section.layout == nil %}
              <div class="section-content">
                {{ section.content | markdownify }}
              </div>
            {% endif %}
            
          </div>
        </section>
      {% endfor %}
      
    </main>
    
    {% include footer.html %}
    
    <!-- Scripts -->
    <script src="{{ 'assets/js/main.js' | relative_url }}"></script>
    <script src="{{ 'assets/js/renaissance.js' | relative_url }}"></script>
    <script src="{{ 'assets/js/codex-anima.js' | relative_url }}"></script>

    <!-- Intersection Observer for animations -->
    <script>
      // Initialize scroll animations
      const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
      };
      
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('visible');
          }
        });
      }, observerOptions);
      
      // Observe all animation elements
      document.addEventListener('DOMContentLoaded', () => {
        document.querySelectorAll('.fade-in, .slide-in-left, .slide-in-right').forEach(el => {
          observer.observe(el);
        });
      });
    </script>
    
  </body>
</html>

