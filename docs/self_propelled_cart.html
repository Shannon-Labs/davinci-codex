<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leonardo's Self-Propelled Cart - First Autonomous Vehicle</title>
    <link rel="stylesheet" href="leonardo_design_system.css">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #8B4513 0%, #F4E4C1 100%);
            font-family: var(--font-leonardo-body);
            min-height: 100vh;
        }

        .cart-container {
            max-width: 1800px;
            margin: 0 auto;
            padding: var(--space-golden-xl);
        }

        .header-section {
            text-align: center;
            margin-bottom: var(--space-golden-xxl);
            padding: var(--space-golden-xxl);
            background: rgba(255, 255, 255, 0.9);
            border-radius: var(--space-golden-lg);
            box-shadow: var(--shadow-leonardo-elevated);
            position: relative;
            overflow: hidden;
        }

        .header-section::before {
            content: 'üõû';
            position: absolute;
            font-size: 15em;
            opacity: 0.05;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .main-title {
            font-family: var(--font-leonardo-display);
            font-size: 4em;
            color: var(--leonardo-ink);
            margin-bottom: var(--space-golden-md);
            text-shadow: 3px 3px 6px rgba(44, 24, 16, 0.2);
            position: relative;
            z-index: 1;
        }

        .subtitle {
            font-size: 1.5em;
            color: var(--leonardo-umber);
            font-style: italic;
            margin-bottom: var(--space-golden-lg);
        }

        .auto-badge {
            display: inline-block;
            background: linear-gradient(45deg, #8B4513, #D2691E);
            color: white;
            padding: var(--space-golden-sm) var(--space-golden-lg);
            border-radius: var(--space-golden-lg);
            font-family: var(--font-leonardo-display);
            font-size: 1.2em;
            letter-spacing: 0.05em;
            box-shadow: 0 0 30px rgba(139, 69, 19, 0.6);
            animation: leonardoPulse 2s infinite;
            margin: var(--space-golden-md) 0;
        }

        .cart-layout {
            display: grid;
            grid-template-columns: 350px 1fr 320px;
            gap: var(--space-golden-xl);
            margin-bottom: var(--space-golden-xxl);
        }

        .control-panel, .analysis-panel {
            background: rgba(255, 255, 255, 0.85);
            padding: var(--space-golden-lg);
            border-radius: var(--space-golden-md);
            box-shadow: var(--shadow-leonardo-manuscript);
            height: fit-content;
        }

        .simulation-workspace {
            background: rgba(255, 255, 255, 0.95);
            padding: var(--space-golden-xl);
            border-radius: var(--space-golden-lg);
            box-shadow: var(--shadow-leonardo-elevated);
            min-height: 700px;
        }

        .panel-title {
            font-family: var(--font-leonardo-display);
            font-size: 1.8em;
            color: var(--leonardo-crimson);
            margin-bottom: var(--space-golden-lg);
            text-align: center;
            border-bottom: 2px solid var(--leonardo-gold);
            padding-bottom: var(--space-golden-sm);
        }

        .cart-canvas {
            width: 100%;
            height: 400px;
            background: linear-gradient(180deg, rgba(135, 206, 235, 0.2), rgba(139, 69, 19, 0.1));
            border: 2px solid var(--leonardo-umber);
            border-radius: var(--space-golden-md);
            position: relative;
            overflow: hidden;
            margin-bottom: var(--space-golden-lg);
        }

        #cartCanvas {
            width: 100%;
            height: 100%;
        }

        .spring-visual {
            width: 100%;
            height: 150px;
            background: rgba(255, 215, 0, 0.1);
            border: 2px solid var(--leonardo-gold);
            border-radius: var(--space-golden-sm);
            margin: var(--space-golden-md) 0;
            position: relative;
        }

        .metric-card {
            background: linear-gradient(135deg, rgba(139, 69, 19, 0.1), rgba(255, 215, 0, 0.1));
            border: 2px solid var(--leonardo-umber);
            border-radius: var(--space-golden-sm);
            padding: var(--space-golden-md);
            margin-bottom: var(--space-golden-md);
            text-align: center;
            transition: all var(--anim-leonardo-medium);
        }

        .metric-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--glow-leonardo);
        }

        .metric-label {
            font-size: 0.9em;
            color: var(--leonardo-umber);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: var(--space-golden-xs);
        }

        .metric-value {
            font-size: 2em;
            color: var(--leonardo-crimson);
            font-weight: 700;
            font-family: var(--font-leonardo-display);
        }

        .metric-unit {
            font-size: 0.7em;
            color: var(--leonardo-ink);
            opacity: 0.7;
        }

        @media (max-width: 1200px) {
            .cart-layout {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="cart-container">
        <div class="header-section">
            <h1 class="main-title">üõû Leonardo's Self-Propelled Cart</h1>
            <p class="subtitle">The World's First Autonomous Vehicle (c. 1478)</p>
            <div class="auto-badge">‚öôÔ∏è WORLD'S FIRST PROGRAMMABLE AUTOMATON ‚öôÔ∏è</div>
            <p style="font-size: 1.2em; color: var(--leonardo-ink); margin-top: var(--space-golden-lg);">
                <strong>Spring-Driven Excellence:</strong> 40 meters range with 3-stage gear reduction
            </p>
        </div>

        <div style="background: rgba(255, 255, 255, 0.9); padding: var(--space-golden-lg); border-radius: var(--space-golden-md); margin-bottom: var(--space-golden-xl); max-width: 900px; margin-left: auto; margin-right: auto;">
            <p style="font-size: 1.3em; font-style: italic; text-align: center; color: var(--leonardo-umber); line-height: 1.618;">
                "This mechanical cart moves by itself through the power of springs, with gears that control its motion and path."
            </p>
            <p style="text-align: right; font-weight: 600; color: var(--leonardo-ink); margin-top: var(--space-golden-sm);">
                ‚Äî Leonardo da Vinci, Codex Atlanticus (c. 1478), folio 812r
            </p>
        </div>

        <div class="cart-layout">
            <div class="control-panel">
                <h2 class="panel-title">‚öôÔ∏è Spring Controls</h2>

                <div style="margin-bottom: var(--space-golden-lg); padding: var(--space-golden-md); background: rgba(139, 69, 19, 0.1); border-radius: var(--space-golden-sm);">
                    <label style="font-family: var(--font-leonardo-display); font-size: 1.1em; color: var(--leonardo-umber); display: block; margin-bottom: var(--space-golden-sm);">Spring Material</label>
                    <select id="springMaterial" style="width: 100%; padding: var(--space-golden-sm); font-size: 1.1em; border: 2px solid var(--leonardo-umber); border-radius: var(--space-golden-xs);">
                        <option value="high_carbon_steel">High Carbon Steel</option>
                        <option value="bronze_spring">Bronze Spring</option>
                        <option value="advanced_renaissance_alloy">Advanced Renaissance</option>
                        <option value="modern_spring_steel">Modern Spring Steel</option>
                    </select>
                </div>

                <div style="margin-bottom: var(--space-golden-lg); padding: var(--space-golden-md); background: rgba(139, 69, 19, 0.1); border-radius: var(--space-golden-sm);">
                    <label style="font-family: var(--font-leonardo-display); font-size: 1.1em; color: var(--leonardo-umber); display: block; margin-bottom: var(--space-golden-sm);">Initial Wind Angle</label>
                    <div style="font-size: 1.5em; color: var(--leonardo-crimson); font-weight: 600; text-align: center; margin: var(--space-golden-sm) 0;" id="windValue">14.0 rad</div>
                    <input type="range" style="width: 100%;" id="windSlider" min="8" max="25" value="14" step="0.5">
                </div>

                <button class="leonardo-button" onclick="startCart()" style="width: 100%; margin-bottom: var(--space-golden-sm);">
                    üöÄ Release Cart
                </button>
                <button class="leonardo-button" onclick="resetCart()" style="width: 100%; background: linear-gradient(45deg, var(--leonardo-sage), var(--leonardo-sage-light));">
                    üîÑ Reset
                </button>

                <div class="spring-visual" id="springVisual">
                    <canvas id="springCanvas" width="300" height="150"></canvas>
                </div>
            </div>

            <div class="simulation-workspace">
                <h3 style="font-family: var(--font-leonardo-display); text-align: center; color: var(--leonardo-crimson);">
                    Autonomous Motion Simulation
                </h3>
                <div class="cart-canvas">
                    <canvas id="cartCanvas"></canvas>
                </div>

                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: var(--space-golden-md);">
                    <div class="metric-card">
                        <div class="metric-label">Distance</div>
                        <div class="metric-value" id="distanceValue">0<span class="metric-unit"> m</span></div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label">Velocity</div>
                        <div class="metric-value" id="velocityValue">0.0<span class="metric-unit"> m/s</span></div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label">Spring Energy</div>
                        <div class="metric-value" id="energyValue">100<span class="metric-unit">%</span></div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-label">Runtime</div>
                        <div class="metric-value" id="timeValue">0<span class="metric-unit"> s</span></div>
                    </div>
                </div>

                <div style="margin-top: var(--space-golden-xl);">
                    <h4 style="font-family: var(--font-leonardo-display); color: var(--leonardo-umber);">Engineering Innovations:</h4>
                    <ul style="line-height: 1.8; font-size: 1.1em;">
                        <li><strong>3-Stage Gear Reduction:</strong> 3.0 √ó 2.5 √ó 4.0 = 30:1 total ratio for torque multiplication</li>
                        <li><strong>Escapement Control:</strong> 12-tooth mechanism regulates speed for smooth motion</li>
                        <li><strong>Nonlinear Springs:</strong> Torsion springs with cubic stiffness for extended range</li>
                        <li><strong>Programmable Path:</strong> Pre-set steering angles for autonomous navigation</li>
                        <li><strong>Bearing Optimization:</strong> Bronze bearings with minimal friction loss</li>
                    </ul>
                </div>
            </div>

            <div class="analysis-panel">
                <h2 class="panel-title">üìä Performance</h2>

                <div class="metric-card">
                    <div class="metric-label">Max Range</div>
                    <div class="metric-value">40<span class="metric-unit"> m</span></div>
                </div>

                <div class="metric-card">
                    <div class="metric-label">Peak Speed</div>
                    <div class="metric-value">0.8<span class="metric-unit"> m/s</span></div>
                </div>

                <div class="metric-card">
                    <div class="metric-label">Gear Efficiency</div>
                    <div class="metric-value">73<span class="metric-unit">%</span></div>
                </div>

                <div class="metric-card">
                    <div class="metric-label">Cart Mass</div>
                    <div class="metric-value">20<span class="metric-unit"> kg</span></div>
                </div>

                <div style="margin-top: var(--space-golden-xl); padding: var(--space-golden-md); background: rgba(139, 69, 19, 0.1); border-radius: var(--space-golden-sm);">
                    <h4 style="font-family: var(--font-leonardo-display); color: var(--leonardo-crimson); margin-bottom: var(--space-golden-sm);">
                        Historical First
                    </h4>
                    <p style="font-size: 0.95em; line-height: 1.6;">
                        Designed c. 1478, this cart predates automobiles by 400 years and represents the first programmable autonomous vehicle.
                    </p>
                </div>
            </div>
        </div>

        <div style="background: rgba(255, 255, 255, 0.9); padding: var(--space-golden-xl); border-radius: var(--space-golden-lg); box-shadow: var(--shadow-leonardo-manuscript);">
            <h2 style="font-family: var(--font-leonardo-display); font-size: 2.5em; color: var(--leonardo-crimson); text-align: center; margin-bottom: var(--space-golden-xl);">
                üìú Historical Context & Engineering
            </h2>

            <div style="background: rgba(139, 69, 19, 0.1); border-left: 4px solid var(--leonardo-umber); padding: var(--space-golden-md); margin: var(--space-golden-lg) 0; font-style: italic;">
                <strong>Primary Source:</strong> Codex Atlanticus, Folio 812r (c. 1478)<br>
                <strong>Purpose:</strong> Theatrical automaton for court performances<br>
                <strong>Innovation:</strong> First self-propelled programmable vehicle in history
            </div>

            <p style="font-size: 1.2em; line-height: 1.8;">
                Leonardo's self-propelled cart, designed around 1478, represents one of the earliest examples of programmable automation. Built for theatrical performances at Renaissance courts, it could travel predetermined paths autonomously using spring power, sophisticated gear trains, and escapement regulation.
            </p>

            <h3 style="font-family: var(--font-leonardo-display); color: var(--leonardo-umber); margin-top: var(--space-golden-xl);">
                Technical Achievements:
            </h3>
            <ul style="font-size: 1.1em; line-height: 1.8;">
                <li><strong>Spring Energy Storage:</strong> Multiple laminated torsion springs wound to 14+ radians</li>
                <li><strong>Multi-Stage Gearing:</strong> 30:1 total reduction for optimal torque/speed balance</li>
                <li><strong>Escapement Regulation:</strong> Controlled release prevents runaway acceleration</li>
                <li><strong>Programmable Steering:</strong> Pre-set angles via cam mechanism for path control</li>
                <li><strong>Performance Range:</strong> 40 meters on single winding with controllable speed</li>
            </ul>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('cartCanvas');
        const ctx = canvas.getContext('2d');
        const springCanvas = document.getElementById('springCanvas');
        const springCtx = springCanvas.getContext('2d');

        function resizeCanvas() {
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        let cartX = 50;
        let cartVelocity = 0;
        let springAngle = 14.0;
        let springEnergy = 100;
        let running = false;
        let simTime = 0;
        let distance = 0;

        document.getElementById('windSlider').addEventListener('input', function(e) {
            springAngle = parseFloat(e.target.value);
            document.getElementById('windValue').textContent = springAngle.toFixed(1) + ' rad';
            drawSpring();
        });

        function startCart() {
            if (!running) {
                running = true;
                springEnergy = 100;
                simTime = 0;
                distance = 0;
            }
        }

        function resetCart() {
            running = false;
            cartX = 50;
            cartVelocity = 0;
            springAngle = parseFloat(document.getElementById('windSlider').value);
            springEnergy = 100;
            simTime = 0;
            distance = 0;
            updateDisplays();
            drawSpring();
        }

        function updateDisplays() {
            document.getElementById('distanceValue').innerHTML = distance.toFixed(1) + '<span class="metric-unit"> m</span>';
            document.getElementById('velocityValue').innerHTML = cartVelocity.toFixed(2) + '<span class="metric-unit"> m/s</span>';
            document.getElementById('energyValue').innerHTML = Math.round(springEnergy) + '<span class="metric-unit">%</span>';
            document.getElementById('timeValue').innerHTML = simTime.toFixed(1) + '<span class="metric-unit"> s</span>';
        }

        function drawSpring() {
            springCtx.clearRect(0, 0, 300, 150);
            const centerY = 75;
            const winds = Math.floor(springAngle / (Math.PI * 2));
            const progress = (springEnergy / 100);

            springCtx.strokeStyle = '#8B4513';
            springCtx.lineWidth = 3;
            springCtx.beginPath();

            for (let i = 0; i < winds * 2; i++) {
                const x = 50 + i * 15;
                const y = centerY + (i % 2 === 0 ? -20 : 20) * progress;
                if (i === 0) springCtx.moveTo(x, y);
                else springCtx.lineTo(x, y);
            }
            springCtx.stroke();

            springCtx.fillStyle = '#FFD700';
            springCtx.font = 'bold 16px serif';
            springCtx.fillText(`Energy: ${Math.round(springEnergy)}%`, 10, 20);
        }

        function drawCart() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Ground
            ctx.strokeStyle = '#8B4513';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(0, canvas.height - 50);
            ctx.lineTo(canvas.width, canvas.height - 50);
            ctx.stroke();

            // Cart body
            const cartY = canvas.height - 100;
            ctx.fillStyle = '#D2691E';
            ctx.strokeStyle = '#8B4513';
            ctx.lineWidth = 2;
            ctx.fillRect(cartX, cartY, 80, 40);
            ctx.strokeRect(cartX, cartY, 80, 40);

            // Wheels
            ctx.fillStyle = '#654321';
            ctx.beginPath();
            ctx.arc(cartX + 20, cartY + 50, 15, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();
            ctx.beginPath();
            ctx.arc(cartX + 60, cartY + 50, 15, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();

            // Gear indicator
            ctx.fillStyle = '#FFD700';
            ctx.beginPath();
            ctx.arc(cartX + 40, cartY + 20, 8, 0, Math.PI * 2);
            ctx.fill();
        }

        function animate() {
            if (running && springEnergy > 1) {
                const dt = 0.05;
                simTime += dt;

                // Physics simulation
                const k = 32.0; // Spring constant
                const gearRatio = 30.0;
                const efficiency = 0.73;
                const wheelRadius = 0.15;
                const mass = 20.0;

                const springTorque = k * (springAngle * springEnergy / 100);
                const driveTorque = springTorque * gearRatio * efficiency;
                const driveForce = driveTorque / wheelRadius;

                const drag = 0.5 * 1.225 * 0.02 * 0.3 * cartVelocity * cartVelocity;
                const rolling = 0.02 * mass * 9.81;

                const netForce = driveForce - drag - rolling;
                const acceleration = netForce / mass;

                cartVelocity = Math.max(0, cartVelocity + acceleration * dt);
                distance += cartVelocity * dt;
                cartX += cartVelocity * dt * 15; // Visual scaling

                springEnergy = Math.max(0, springEnergy - (cartVelocity / wheelRadius) * 0.5);

                if (cartX > canvas.width - 100) {
                    cartX = 50;
                }

                if (cartVelocity < 0.01) {
                    running = false;
                }

                updateDisplays();
            }

            drawCart();
            drawSpring();
            requestAnimationFrame(animate);
        }

        drawSpring();
        animate();
    </script>
</body>
</html>
